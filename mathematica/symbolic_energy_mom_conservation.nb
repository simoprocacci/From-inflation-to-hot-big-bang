(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Wolfram 14.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       154,          7]
NotebookDataLength[     40186,       1183]
NotebookOptionsPosition[     38018,       1135]
NotebookOutlinePosition[     38451,       1152]
CellTagsIndexPosition[     38408,       1149]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["\<\
Ricci scalar to first order in the presence of 
a general perturbation \
\>", "Subsection",
 CellChangeTimes->{{3.977010885904499*^9, 
  3.977010906528632*^9}},ExpressionUUID->"d06c4045-7009-45c2-af5c-\
05575649d531"],

Cell[CellGroupData[{

Cell["Insert metric", "Subsubsection",
 CellChangeTimes->{{3.9770109128013487`*^9, 
  3.977010915563354*^9}},ExpressionUUID->"b6d3b268-42ec-4627-952d-\
c8abe4884ab1"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"gdown", "[", 
    RowBox[{"0", ",", "0"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"a", "[", 
      RowBox[{"x", "[", "0", "]"}], "]"}], "^", "2"}], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "-", 
      RowBox[{"2", "eps", " ", 
       RowBox[{"h0", "[", 
        RowBox[{
         RowBox[{"x", "[", "0", "]"}], ",", 
         RowBox[{"x", "[", "1", "]"}], ",", 
         RowBox[{"x", "[", "2", "]"}], ",", 
         RowBox[{"x", "[", "3", "]"}]}], "]"}]}]}], ")"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"gdown", "[", 
    RowBox[{"0", ",", "1"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"a", "[", 
      RowBox[{"x", "[", "0", "]"}], "]"}], "^", "2"}], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "eps"}], " ", 
      RowBox[{"h1", "[", 
       RowBox[{
        RowBox[{"x", "[", "0", "]"}], ",", 
        RowBox[{"x", "[", "1", "]"}], ",", 
        RowBox[{"x", "[", "2", "]"}], ",", 
        RowBox[{"x", "[", "3", "]"}]}], "]"}]}], ")"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"gdown", "[", 
    RowBox[{"0", ",", "2"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"a", "[", 
      RowBox[{"x", "[", "0", "]"}], "]"}], "^", "2"}], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "eps"}], " ", 
      RowBox[{"h2", "[", 
       RowBox[{
        RowBox[{"x", "[", "0", "]"}], ",", 
        RowBox[{"x", "[", "1", "]"}], ",", 
        RowBox[{"x", "[", "2", "]"}], ",", 
        RowBox[{"x", "[", "3", "]"}]}], "]"}]}], ")"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"gdown", "[", 
    RowBox[{"0", ",", "3"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"a", "[", 
      RowBox[{"x", "[", "0", "]"}], "]"}], "^", "2"}], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "eps"}], " ", 
      RowBox[{"h3", "[", 
       RowBox[{
        RowBox[{"x", "[", "0", "]"}], ",", 
        RowBox[{"x", "[", "1", "]"}], ",", 
        RowBox[{"x", "[", "2", "]"}], ",", 
        RowBox[{"x", "[", "3", "]"}]}], "]"}]}], ")"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"gdown", "[", 
    RowBox[{"1", ",", "0"}], "]"}], ":=", 
   RowBox[{"gdown", "[", 
    RowBox[{"0", ",", "1"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"gdown", "[", 
    RowBox[{"2", ",", "0"}], "]"}], ":=", 
   RowBox[{"gdown", "[", 
    RowBox[{"0", ",", "2"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"gdown", "[", 
    RowBox[{"3", ",", "0"}], "]"}], ":=", 
   RowBox[{"gdown", "[", 
    RowBox[{"0", ",", "3"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"gdown", "[", 
    RowBox[{"1", ",", "1"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"a", "[", 
      RowBox[{"x", "[", "0", "]"}], "]"}], "^", "2"}], 
    RowBox[{"(", 
     RowBox[{"1", "-", 
      RowBox[{"2", " ", "eps", " ", 
       RowBox[{"hD", "[", 
        RowBox[{
         RowBox[{"x", "[", "0", "]"}], ",", 
         RowBox[{"x", "[", "1", "]"}], ",", 
         RowBox[{"x", "[", "2", "]"}], ",", 
         RowBox[{"x", "[", "3", "]"}]}], "]"}]}], "+", 
      RowBox[{"2", " ", "eps", " ", 
       RowBox[{"theta11", "[", 
        RowBox[{
         RowBox[{"x", "[", "0", "]"}], ",", 
         RowBox[{"x", "[", "1", "]"}], ",", 
         RowBox[{"x", "[", "2", "]"}], ",", 
         RowBox[{"x", "[", "3", "]"}]}], "]"}]}]}], ")"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"gdown", "[", 
    RowBox[{"2", ",", "2"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"a", "[", 
      RowBox[{"x", "[", "0", "]"}], "]"}], "^", "2"}], 
    RowBox[{"(", 
     RowBox[{"1", "-", 
      RowBox[{"2", " ", "eps", " ", 
       RowBox[{"hD", "[", 
        RowBox[{
         RowBox[{"x", "[", "0", "]"}], ",", 
         RowBox[{"x", "[", "1", "]"}], ",", 
         RowBox[{"x", "[", "2", "]"}], ",", 
         RowBox[{"x", "[", "3", "]"}]}], "]"}]}], "+", 
      RowBox[{"2", " ", "eps", " ", 
       RowBox[{"theta22", "[", 
        RowBox[{
         RowBox[{"x", "[", "0", "]"}], ",", 
         RowBox[{"x", "[", "1", "]"}], ",", 
         RowBox[{"x", "[", "2", "]"}], ",", 
         RowBox[{"x", "[", "3", "]"}]}], "]"}]}]}], ")"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"gdown", "[", 
    RowBox[{"3", ",", "3"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"a", "[", 
      RowBox[{"x", "[", "0", "]"}], "]"}], "^", "2"}], 
    RowBox[{"(", 
     RowBox[{"1", "-", 
      RowBox[{"2", " ", "eps", " ", 
       RowBox[{"hD", "[", 
        RowBox[{
         RowBox[{"x", "[", "0", "]"}], ",", 
         RowBox[{"x", "[", "1", "]"}], ",", 
         RowBox[{"x", "[", "2", "]"}], ",", 
         RowBox[{"x", "[", "3", "]"}]}], "]"}]}], "+", 
      RowBox[{"2", " ", "eps", " ", 
       RowBox[{"theta33", "[", 
        RowBox[{
         RowBox[{"x", "[", "0", "]"}], ",", 
         RowBox[{"x", "[", "1", "]"}], ",", 
         RowBox[{"x", "[", "2", "]"}], ",", 
         RowBox[{"x", "[", "3", "]"}]}], "]"}]}]}], ")"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"gdown", "[", 
    RowBox[{"1", ",", "2"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"a", "[", 
      RowBox[{"x", "[", "0", "]"}], "]"}], "^", "2"}], 
    RowBox[{"(", 
     RowBox[{"2", "eps", " ", 
      RowBox[{"theta12", "[", 
       RowBox[{
        RowBox[{"x", "[", "0", "]"}], ",", 
        RowBox[{"x", "[", "1", "]"}], ",", 
        RowBox[{"x", "[", "2", "]"}], ",", 
        RowBox[{"x", "[", "3", "]"}]}], "]"}]}], ")"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"gdown", "[", 
    RowBox[{"1", ",", "3"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"a", "[", 
      RowBox[{"x", "[", "0", "]"}], "]"}], "^", "2"}], 
    RowBox[{"(", 
     RowBox[{"2", "eps", " ", 
      RowBox[{"theta13", "[", 
       RowBox[{
        RowBox[{"x", "[", "0", "]"}], ",", 
        RowBox[{"x", "[", "1", "]"}], ",", 
        RowBox[{"x", "[", "2", "]"}], ",", 
        RowBox[{"x", "[", "3", "]"}]}], "]"}]}], ")"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"gdown", "[", 
    RowBox[{"2", ",", "3"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"a", "[", 
      RowBox[{"x", "[", "0", "]"}], "]"}], "^", "2"}], 
    RowBox[{"(", 
     RowBox[{"2", "eps", " ", 
      RowBox[{"theta23", "[", 
       RowBox[{
        RowBox[{"x", "[", "0", "]"}], ",", 
        RowBox[{"x", "[", "1", "]"}], ",", 
        RowBox[{"x", "[", "2", "]"}], ",", 
        RowBox[{"x", "[", "3", "]"}]}], "]"}]}], ")"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"gdown", "[", 
    RowBox[{"2", ",", "1"}], "]"}], ":=", 
   RowBox[{"gdown", "[", 
    RowBox[{"1", ",", "2"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"gdown", "[", 
    RowBox[{"3", ",", "1"}], "]"}], ":=", 
   RowBox[{"gdown", "[", 
    RowBox[{"1", ",", "3"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"gdown", "[", 
    RowBox[{"3", ",", "2"}], "]"}], ":=", 
   RowBox[{"gdown", "[", 
    RowBox[{"2", ",", "3"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.977011116101614*^9, 3.9770111161016397`*^9}},
 CellLabel->"In[1]:=",ExpressionUUID->"b0fa8cd4-7abf-436d-b225-af325b78b66f"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Insert inverse metric", "Subsubsection",
 CellChangeTimes->{{3.977011130218885*^9, 
  3.977011136389844*^9}},ExpressionUUID->"cd4ad19d-a32f-44ba-b66c-\
94a6b8ba8a73"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"gup", "[", 
    RowBox[{"0", ",", "0"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"a", "[", 
      RowBox[{"x", "[", "0", "]"}], "]"}], "^", 
     RowBox[{"(", 
      RowBox[{"-", "2"}], ")"}]}], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", 
      RowBox[{"2", "eps", " ", 
       RowBox[{"h0", "[", 
        RowBox[{
         RowBox[{"x", "[", "0", "]"}], ",", 
         RowBox[{"x", "[", "1", "]"}], ",", 
         RowBox[{"x", "[", "2", "]"}], ",", 
         RowBox[{"x", "[", "3", "]"}]}], "]"}]}]}], ")"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"gup", "[", 
    RowBox[{"0", ",", "1"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"a", "[", 
      RowBox[{"x", "[", "0", "]"}], "]"}], "^", 
     RowBox[{"(", 
      RowBox[{"-", "2"}], ")"}]}], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "eps"}], " ", 
      RowBox[{"h1", "[", 
       RowBox[{
        RowBox[{"x", "[", "0", "]"}], ",", 
        RowBox[{"x", "[", "1", "]"}], ",", 
        RowBox[{"x", "[", "2", "]"}], ",", 
        RowBox[{"x", "[", "3", "]"}]}], "]"}]}], ")"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"gup", "[", 
    RowBox[{"0", ",", "2"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"a", "[", 
      RowBox[{"x", "[", "0", "]"}], "]"}], "^", 
     RowBox[{"(", 
      RowBox[{"-", "2"}], ")"}]}], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "eps"}], " ", 
      RowBox[{"h2", "[", 
       RowBox[{
        RowBox[{"x", "[", "0", "]"}], ",", 
        RowBox[{"x", "[", "1", "]"}], ",", 
        RowBox[{"x", "[", "2", "]"}], ",", 
        RowBox[{"x", "[", "3", "]"}]}], "]"}]}], ")"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"gup", "[", 
    RowBox[{"0", ",", "3"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"a", "[", 
      RowBox[{"x", "[", "0", "]"}], "]"}], "^", 
     RowBox[{"(", 
      RowBox[{"-", "2"}], ")"}]}], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "eps"}], " ", 
      RowBox[{"h3", "[", 
       RowBox[{
        RowBox[{"x", "[", "0", "]"}], ",", 
        RowBox[{"x", "[", "1", "]"}], ",", 
        RowBox[{"x", "[", "2", "]"}], ",", 
        RowBox[{"x", "[", "3", "]"}]}], "]"}]}], ")"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"gup", "[", 
    RowBox[{"1", ",", "0"}], "]"}], ":=", 
   RowBox[{"gup", "[", 
    RowBox[{"0", ",", "1"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"gup", "[", 
    RowBox[{"2", ",", "0"}], "]"}], ":=", 
   RowBox[{"gup", "[", 
    RowBox[{"0", ",", "2"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"gup", "[", 
    RowBox[{"3", ",", "0"}], "]"}], ":=", 
   RowBox[{"gup", "[", 
    RowBox[{"0", ",", "3"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"gup", "[", 
    RowBox[{"1", ",", "1"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"a", "[", 
      RowBox[{"x", "[", "0", "]"}], "]"}], "^", 
     RowBox[{"(", 
      RowBox[{"-", "2"}], ")"}]}], 
    RowBox[{"(", 
     RowBox[{"1", "+", 
      RowBox[{"2", " ", "eps", " ", 
       RowBox[{"hD", "[", 
        RowBox[{
         RowBox[{"x", "[", "0", "]"}], ",", 
         RowBox[{"x", "[", "1", "]"}], ",", 
         RowBox[{"x", "[", "2", "]"}], ",", 
         RowBox[{"x", "[", "3", "]"}]}], "]"}]}], "-", 
      RowBox[{"2", " ", "eps", " ", 
       RowBox[{"theta11", "[", 
        RowBox[{
         RowBox[{"x", "[", "0", "]"}], ",", 
         RowBox[{"x", "[", "1", "]"}], ",", 
         RowBox[{"x", "[", "2", "]"}], ",", 
         RowBox[{"x", "[", "3", "]"}]}], "]"}]}]}], ")"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"gup", "[", 
    RowBox[{"2", ",", "2"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"a", "[", 
      RowBox[{"x", "[", "0", "]"}], "]"}], "^", 
     RowBox[{"(", 
      RowBox[{"-", "2"}], ")"}]}], 
    RowBox[{"(", 
     RowBox[{"1", "+", 
      RowBox[{"2", " ", "eps", " ", 
       RowBox[{"hD", "[", 
        RowBox[{
         RowBox[{"x", "[", "0", "]"}], ",", 
         RowBox[{"x", "[", "1", "]"}], ",", 
         RowBox[{"x", "[", "2", "]"}], ",", 
         RowBox[{"x", "[", "3", "]"}]}], "]"}]}], "-", 
      RowBox[{"2", " ", "eps", " ", 
       RowBox[{"theta22", "[", 
        RowBox[{
         RowBox[{"x", "[", "0", "]"}], ",", 
         RowBox[{"x", "[", "1", "]"}], ",", 
         RowBox[{"x", "[", "2", "]"}], ",", 
         RowBox[{"x", "[", "3", "]"}]}], "]"}]}]}], ")"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"gup", "[", 
    RowBox[{"3", ",", "3"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"a", "[", 
      RowBox[{"x", "[", "0", "]"}], "]"}], "^", 
     RowBox[{"(", 
      RowBox[{"-", "2"}], ")"}]}], 
    RowBox[{"(", 
     RowBox[{"1", "+", 
      RowBox[{"2", " ", "eps", " ", 
       RowBox[{"hD", "[", 
        RowBox[{
         RowBox[{"x", "[", "0", "]"}], ",", 
         RowBox[{"x", "[", "1", "]"}], ",", 
         RowBox[{"x", "[", "2", "]"}], ",", 
         RowBox[{"x", "[", "3", "]"}]}], "]"}]}], "-", 
      RowBox[{"2", " ", "eps", " ", 
       RowBox[{"theta33", "[", 
        RowBox[{
         RowBox[{"x", "[", "0", "]"}], ",", 
         RowBox[{"x", "[", "1", "]"}], ",", 
         RowBox[{"x", "[", "2", "]"}], ",", 
         RowBox[{"x", "[", "3", "]"}]}], "]"}]}]}], ")"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"gup", "[", 
    RowBox[{"1", ",", "2"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"a", "[", 
      RowBox[{"x", "[", "0", "]"}], "]"}], "^", 
     RowBox[{"(", 
      RowBox[{"-", "2"}], ")"}]}], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "2"}], "eps", " ", 
      RowBox[{"theta12", "[", 
       RowBox[{
        RowBox[{"x", "[", "0", "]"}], ",", 
        RowBox[{"x", "[", "1", "]"}], ",", 
        RowBox[{"x", "[", "2", "]"}], ",", 
        RowBox[{"x", "[", "3", "]"}]}], "]"}]}], ")"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"gup", "[", 
    RowBox[{"1", ",", "3"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"a", "[", 
      RowBox[{"x", "[", "0", "]"}], "]"}], "^", 
     RowBox[{"(", 
      RowBox[{"-", "2"}], ")"}]}], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "2"}], "eps", " ", 
      RowBox[{"theta13", "[", 
       RowBox[{
        RowBox[{"x", "[", "0", "]"}], ",", 
        RowBox[{"x", "[", "1", "]"}], ",", 
        RowBox[{"x", "[", "2", "]"}], ",", 
        RowBox[{"x", "[", "3", "]"}]}], "]"}]}], ")"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"gup", "[", 
    RowBox[{"2", ",", "3"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"a", "[", 
      RowBox[{"x", "[", "0", "]"}], "]"}], "^", 
     RowBox[{"(", 
      RowBox[{"-", "2"}], ")"}]}], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "2"}], "eps", " ", 
      RowBox[{"theta23", "[", 
       RowBox[{
        RowBox[{"x", "[", "0", "]"}], ",", 
        RowBox[{"x", "[", "1", "]"}], ",", 
        RowBox[{"x", "[", "2", "]"}], ",", 
        RowBox[{"x", "[", "3", "]"}]}], "]"}]}], ")"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"gup", "[", 
    RowBox[{"2", ",", "1"}], "]"}], ":=", 
   RowBox[{"gup", "[", 
    RowBox[{"1", ",", "2"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"gup", "[", 
    RowBox[{"3", ",", "1"}], "]"}], ":=", 
   RowBox[{"gup", "[", 
    RowBox[{"1", ",", "3"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"gup", "[", 
    RowBox[{"3", ",", "2"}], "]"}], ":=", 
   RowBox[{"gup", "[", 
    RowBox[{"2", ",", "3"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.977011154966104*^9, 3.9770111549661293`*^9}},
 CellLabel->"In[17]:=",ExpressionUUID->"f9bf80b5-3a33-429b-a8f5-896529d9d37b"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Christoffel symbols", "Subsubsection",
 CellChangeTimes->{{3.9770111667166433`*^9, 
  3.97701117359048*^9}},ExpressionUUID->"d6bc33f2-ebd1-405a-aacf-\
7fd7714c65bc"],

Cell[BoxData[
 RowBox[{
  RowBox[{"gamma", "[", 
   RowBox[{"rho_", ",", "mu_", ",", "nu_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"1", "/", "2"}], " ", 
   RowBox[{"Sum", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"gup", "[", 
       RowBox[{"rho", ",", "sigma"}], "]"}], 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"D", "[", 
         RowBox[{
          RowBox[{"gdown", "[", 
           RowBox[{"sigma", ",", "mu"}], "]"}], ",", 
          RowBox[{"x", "[", "nu", "]"}]}], "]"}], "+", 
        RowBox[{"D", "[", 
         RowBox[{
          RowBox[{"gdown", "[", 
           RowBox[{"sigma", ",", "nu"}], "]"}], ",", 
          RowBox[{"x", "[", "mu", "]"}]}], "]"}], "-", 
        RowBox[{"D", "[", 
         RowBox[{
          RowBox[{"gdown", "[", 
           RowBox[{"mu", ",", "nu"}], "]"}], ",", 
          RowBox[{"x", "[", "sigma", "]"}]}], "]"}]}], ")"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"sigma", ",", "0", ",", "3"}], "}"}]}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.977011186026412*^9, 3.977011186026447*^9}},
 CellLabel->"In[33]:=",ExpressionUUID->"b5d1a9ae-6d17-4a4f-ad4c-cc04529babfe"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Ricci tensor with both indices down", "Subsubsection",
 CellChangeTimes->{{3.977011195728549*^9, 
  3.977011203385415*^9}},ExpressionUUID->"4323374a-9c9a-4513-b1b0-\
1793565ed42a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"riccidown", "[", 
   RowBox[{"mu_", ",", "nu_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"Sum", "[", 
    RowBox[{
     RowBox[{"D", "[", 
      RowBox[{
       RowBox[{"gamma", "[", 
        RowBox[{"alpha", ",", "mu", ",", "nu"}], "]"}], ",", 
       RowBox[{"x", "[", "alpha", "]"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"alpha", ",", "0", ",", "3"}], "}"}]}], "]"}], "-", 
   RowBox[{"Sum", "[", 
    RowBox[{
     RowBox[{"D", "[", 
      RowBox[{
       RowBox[{"gamma", "[", 
        RowBox[{"alpha", ",", "mu", ",", "alpha"}], "]"}], ",", 
       RowBox[{"x", "[", "nu", "]"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"alpha", ",", "0", ",", "3"}], "}"}]}], "]"}], "+", 
   RowBox[{"Sum", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"gamma", "[", 
       RowBox[{"beta", ",", "mu", ",", "nu"}], "]"}], 
      RowBox[{"gamma", "[", 
       RowBox[{"alpha", ",", "beta", ",", "alpha"}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"alpha", ",", "0", ",", "3"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"beta", ",", "0", ",", "3"}], "}"}]}], "]"}], "-", 
   RowBox[{"Sum", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"gamma", "[", 
       RowBox[{"beta", ",", "mu", ",", "alpha"}], "]"}], 
      RowBox[{"gamma", "[", 
       RowBox[{"alpha", ",", "beta", ",", "nu"}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"alpha", ",", "0", ",", "3"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"beta", ",", "0", ",", "3"}], "}"}]}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.977011222956822*^9, 3.977011226770231*^9}},
 CellLabel->"In[34]:=",ExpressionUUID->"265ffdda-acec-471c-b1bc-f372132d0eee"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Raise first index in Ricci tensor", "Subsubsection",
 CellChangeTimes->{{3.977011233099242*^9, 
  3.977011240021028*^9}},ExpressionUUID->"a1e21628-467b-44fe-96fc-\
70df45720cab"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ricciupdown", "[", 
   RowBox[{"mu_", ",", "nu_"}], "]"}], ":=", 
  RowBox[{"Sum", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"gup", "[", 
      RowBox[{"mu", ",", "alpha"}], "]"}], 
     RowBox[{"riccidown", "[", 
      RowBox[{"alpha", ",", "nu"}], "]"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"alpha", ",", "0", ",", "3"}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.977011255632533*^9, 3.977011255633877*^9}},
 CellLabel->"In[35]:=",ExpressionUUID->"34af23d8-c893-4cb6-b9df-89d75821d60f"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Ricci scalar", "Subsubsection",
 CellChangeTimes->{{3.977011261126966*^9, 
  3.977011263613832*^9}},ExpressionUUID->"f1d9d585-6900-4b1d-880e-\
3ec4aa71cea0"],

Cell[BoxData[
 RowBox[{"ricciscalar", ":=", 
  RowBox[{"Sum", "[", 
   RowBox[{
    RowBox[{"ricciupdown", "[", 
     RowBox[{"alpha", ",", "alpha"}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"alpha", ",", "0", ",", "3"}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.97701127535444*^9, 3.977011275354466*^9}},
 CellLabel->"In[36]:=",ExpressionUUID->"8704d10f-9966-404c-a26e-856ad1e842af"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Adjust expression until the difference subtracts to zero", \
"Subsubsection",
 CellChangeTimes->{{3.977011282325377*^9, 
  3.977011295866086*^9}},ExpressionUUID->"3304e6bf-f1bc-4ba2-ae9d-\
035394a91b25"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"calH", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"a", "'"}], "[", 
     RowBox[{"x", "[", "0", "]"}], "]"}], "/", 
    RowBox[{"a", "[", 
     RowBox[{"x", "[", "0", "]"}], "]"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"calHp", "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"a", "''"}], "[", 
      RowBox[{"x", "[", "0", "]"}], "]"}], "/", 
     RowBox[{"a", "[", 
      RowBox[{"x", "[", "0", "]"}], "]"}]}], "-", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"a", "'"}], "[", 
        RowBox[{"x", "[", "0", "]"}], "]"}], "/", 
       RowBox[{"a", "[", 
        RowBox[{"x", "[", "0", "]"}], "]"}]}], ")"}], "^", "2"}]}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"testricciscalar", "=", 
    RowBox[{
     RowBox[{"6", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"a", "''"}], "[", 
        RowBox[{"x", "[", "0", "]"}], "]"}], "/", 
       RowBox[{
        RowBox[{"a", "[", 
         RowBox[{"x", "[", "0", "]"}], "]"}], "^", "3"}]}]}], "-", 
     RowBox[{"2", " ", 
      RowBox[{"eps", "/", 
       RowBox[{
        RowBox[{"a", "[", 
         RowBox[{"x", "[", "0", "]"}], "]"}], "^", "2"}]}], 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"+", "3"}], " ", "calH", " ", 
         RowBox[{
          RowBox[{
           RowBox[{"Derivative", "[", 
            RowBox[{"1", ",", "0", ",", "0", ",", "0"}], "]"}], "[", "h0", 
           "]"}], "[", 
          RowBox[{
           RowBox[{"x", "[", "0", "]"}], ",", 
           RowBox[{"x", "[", "1", "]"}], ",", 
           RowBox[{"x", "[", "2", "]"}], ",", 
           RowBox[{"x", "[", "3", "]"}]}], "]"}]}], "+", 
        RowBox[{"6", " ", 
         RowBox[{"(", 
          RowBox[{"calHp", "+", 
           RowBox[{"calH", "^", "2"}]}], ")"}], " ", 
         RowBox[{
          RowBox[{
           RowBox[{"Derivative", "[", 
            RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "]"}], "[", "h0", 
           "]"}], "[", 
          RowBox[{
           RowBox[{"x", "[", "0", "]"}], ",", 
           RowBox[{"x", "[", "1", "]"}], ",", 
           RowBox[{"x", "[", "2", "]"}], ",", 
           RowBox[{"x", "[", "3", "]"}]}], "]"}]}], "+", 
        RowBox[{
         RowBox[{
          RowBox[{"Derivative", "[", 
           RowBox[{"0", ",", "2", ",", "0", ",", "0"}], "]"}], "[", "h0", 
          "]"}], "[", 
         RowBox[{
          RowBox[{"x", "[", "0", "]"}], ",", 
          RowBox[{"x", "[", "1", "]"}], ",", 
          RowBox[{"x", "[", "2", "]"}], ",", 
          RowBox[{"x", "[", "3", "]"}]}], "]"}], "+", 
        RowBox[{
         RowBox[{
          RowBox[{"Derivative", "[", 
           RowBox[{"0", ",", "0", ",", "2", ",", "0"}], "]"}], "[", "h0", 
          "]"}], "[", 
         RowBox[{
          RowBox[{"x", "[", "0", "]"}], ",", 
          RowBox[{"x", "[", "1", "]"}], ",", 
          RowBox[{"x", "[", "2", "]"}], ",", 
          RowBox[{"x", "[", "3", "]"}]}], "]"}], "+", 
        RowBox[{
         RowBox[{
          RowBox[{"Derivative", "[", 
           RowBox[{"0", ",", "0", ",", "0", ",", "2"}], "]"}], "[", "h0", 
          "]"}], "[", 
         RowBox[{
          RowBox[{"x", "[", "0", "]"}], ",", 
          RowBox[{"x", "[", "1", "]"}], ",", 
          RowBox[{"x", "[", "2", "]"}], ",", 
          RowBox[{"x", "[", "3", "]"}]}], "]"}], "-", 
        RowBox[{"2", " ", 
         RowBox[{
          RowBox[{
           RowBox[{"Derivative", "[", 
            RowBox[{"0", ",", "2", ",", "0", ",", "0"}], "]"}], "[", "hD", 
           "]"}], "[", 
          RowBox[{
           RowBox[{"x", "[", "0", "]"}], ",", 
           RowBox[{"x", "[", "1", "]"}], ",", 
           RowBox[{"x", "[", "2", "]"}], ",", 
           RowBox[{"x", "[", "3", "]"}]}], "]"}]}], "-", 
        RowBox[{"2", " ", 
         RowBox[{
          RowBox[{
           RowBox[{"Derivative", "[", 
            RowBox[{"0", ",", "0", ",", "2", ",", "0"}], "]"}], "[", "hD", 
           "]"}], "[", 
          RowBox[{
           RowBox[{"x", "[", "0", "]"}], ",", 
           RowBox[{"x", "[", "1", "]"}], ",", 
           RowBox[{"x", "[", "2", "]"}], ",", 
           RowBox[{"x", "[", "3", "]"}]}], "]"}]}], "-", 
        RowBox[{"2", " ", 
         RowBox[{
          RowBox[{
           RowBox[{"Derivative", "[", 
            RowBox[{"0", ",", "0", ",", "0", ",", "2"}], "]"}], "[", "hD", 
           "]"}], "[", 
          RowBox[{
           RowBox[{"x", "[", "0", "]"}], ",", 
           RowBox[{"x", "[", "1", "]"}], ",", 
           RowBox[{"x", "[", "2", "]"}], ",", 
           RowBox[{"x", "[", "3", "]"}]}], "]"}]}], "+", 
        RowBox[{
         RowBox[{
          RowBox[{"Derivative", "[", 
           RowBox[{"0", ",", "2", ",", "0", ",", "0"}], "]"}], "[", "theta11",
           "]"}], "[", 
         RowBox[{
          RowBox[{"x", "[", "0", "]"}], ",", 
          RowBox[{"x", "[", "1", "]"}], ",", 
          RowBox[{"x", "[", "2", "]"}], ",", 
          RowBox[{"x", "[", "3", "]"}]}], "]"}], "+", 
        RowBox[{
         RowBox[{
          RowBox[{"Derivative", "[", 
           RowBox[{"0", ",", "2", ",", "0", ",", "0"}], "]"}], "[", "theta22",
           "]"}], "[", 
         RowBox[{
          RowBox[{"x", "[", "0", "]"}], ",", 
          RowBox[{"x", "[", "1", "]"}], ",", 
          RowBox[{"x", "[", "2", "]"}], ",", 
          RowBox[{"x", "[", "3", "]"}]}], "]"}], "+", 
        RowBox[{
         RowBox[{
          RowBox[{"Derivative", "[", 
           RowBox[{"0", ",", "2", ",", "0", ",", "0"}], "]"}], "[", "theta33",
           "]"}], "[", 
         RowBox[{
          RowBox[{"x", "[", "0", "]"}], ",", 
          RowBox[{"x", "[", "1", "]"}], ",", 
          RowBox[{"x", "[", "2", "]"}], ",", 
          RowBox[{"x", "[", "3", "]"}]}], "]"}], "+", 
        RowBox[{
         RowBox[{
          RowBox[{"Derivative", "[", 
           RowBox[{"0", ",", "0", ",", "2", ",", "0"}], "]"}], "[", "theta11",
           "]"}], "[", 
         RowBox[{
          RowBox[{"x", "[", "0", "]"}], ",", 
          RowBox[{"x", "[", "1", "]"}], ",", 
          RowBox[{"x", "[", "2", "]"}], ",", 
          RowBox[{"x", "[", "3", "]"}]}], "]"}], "+", 
        RowBox[{
         RowBox[{
          RowBox[{"Derivative", "[", 
           RowBox[{"0", ",", "0", ",", "2", ",", "0"}], "]"}], "[", "theta22",
           "]"}], "[", 
         RowBox[{
          RowBox[{"x", "[", "0", "]"}], ",", 
          RowBox[{"x", "[", "1", "]"}], ",", 
          RowBox[{"x", "[", "2", "]"}], ",", 
          RowBox[{"x", "[", "3", "]"}]}], "]"}], "+", 
        RowBox[{
         RowBox[{
          RowBox[{"Derivative", "[", 
           RowBox[{"0", ",", "0", ",", "2", ",", "0"}], "]"}], "[", "theta33",
           "]"}], "[", 
         RowBox[{
          RowBox[{"x", "[", "0", "]"}], ",", 
          RowBox[{"x", "[", "1", "]"}], ",", 
          RowBox[{"x", "[", "2", "]"}], ",", 
          RowBox[{"x", "[", "3", "]"}]}], "]"}], "+", 
        RowBox[{
         RowBox[{
          RowBox[{"Derivative", "[", 
           RowBox[{"0", ",", "0", ",", "0", ",", "2"}], "]"}], "[", "theta11",
           "]"}], "[", 
         RowBox[{
          RowBox[{"x", "[", "0", "]"}], ",", 
          RowBox[{"x", "[", "1", "]"}], ",", 
          RowBox[{"x", "[", "2", "]"}], ",", 
          RowBox[{"x", "[", "3", "]"}]}], "]"}], "+", 
        RowBox[{
         RowBox[{
          RowBox[{"Derivative", "[", 
           RowBox[{"0", ",", "0", ",", "0", ",", "2"}], "]"}], "[", "theta22",
           "]"}], "[", 
         RowBox[{
          RowBox[{"x", "[", "0", "]"}], ",", 
          RowBox[{"x", "[", "1", "]"}], ",", 
          RowBox[{"x", "[", "2", "]"}], ",", 
          RowBox[{"x", "[", "3", "]"}]}], "]"}], "+", 
        RowBox[{
         RowBox[{
          RowBox[{"Derivative", "[", 
           RowBox[{"0", ",", "0", ",", "0", ",", "2"}], "]"}], "[", "theta33",
           "]"}], "[", 
         RowBox[{
          RowBox[{"x", "[", "0", "]"}], ",", 
          RowBox[{"x", "[", "1", "]"}], ",", 
          RowBox[{"x", "[", "2", "]"}], ",", 
          RowBox[{"x", "[", "3", "]"}]}], "]"}], "+", 
        RowBox[{"3", " ", 
         RowBox[{
          RowBox[{
           RowBox[{"Derivative", "[", 
            RowBox[{"2", ",", "0", ",", "0", ",", "0"}], "]"}], "[", "hD", 
           "]"}], "[", 
          RowBox[{
           RowBox[{"x", "[", "0", "]"}], ",", 
           RowBox[{"x", "[", "1", "]"}], ",", 
           RowBox[{"x", "[", "2", "]"}], ",", 
           RowBox[{"x", "[", "3", "]"}]}], "]"}]}], "+", 
        RowBox[{"9", " ", "calH", " ", 
         RowBox[{
          RowBox[{
           RowBox[{"Derivative", "[", 
            RowBox[{"1", ",", "0", ",", "0", ",", "0"}], "]"}], "[", "hD", 
           "]"}], "[", 
          RowBox[{
           RowBox[{"x", "[", "0", "]"}], ",", 
           RowBox[{"x", "[", "1", "]"}], ",", 
           RowBox[{"x", "[", "2", "]"}], ",", 
           RowBox[{"x", "[", "3", "]"}]}], "]"}]}], "-", 
        RowBox[{
         RowBox[{
          RowBox[{"Derivative", "[", 
           RowBox[{"1", ",", "1", ",", "0", ",", "0"}], "]"}], "[", "h1", 
          "]"}], "[", 
         RowBox[{
          RowBox[{"x", "[", "0", "]"}], ",", 
          RowBox[{"x", "[", "1", "]"}], ",", 
          RowBox[{"x", "[", "2", "]"}], ",", 
          RowBox[{"x", "[", "3", "]"}]}], "]"}], "-", 
        RowBox[{
         RowBox[{
          RowBox[{"Derivative", "[", 
           RowBox[{"1", ",", "0", ",", "1", ",", "0"}], "]"}], "[", "h2", 
          "]"}], "[", 
         RowBox[{
          RowBox[{"x", "[", "0", "]"}], ",", 
          RowBox[{"x", "[", "1", "]"}], ",", 
          RowBox[{"x", "[", "2", "]"}], ",", 
          RowBox[{"x", "[", "3", "]"}]}], "]"}], "-", 
        RowBox[{
         RowBox[{
          RowBox[{"Derivative", "[", 
           RowBox[{"1", ",", "0", ",", "0", ",", "1"}], "]"}], "[", "h3", 
          "]"}], "[", 
         RowBox[{
          RowBox[{"x", "[", "0", "]"}], ",", 
          RowBox[{"x", "[", "1", "]"}], ",", 
          RowBox[{"x", "[", "2", "]"}], ",", 
          RowBox[{"x", "[", "3", "]"}]}], "]"}], "-", 
        RowBox[{"3", " ", "calH", " ", 
         RowBox[{
          RowBox[{
           RowBox[{"Derivative", "[", 
            RowBox[{"0", ",", "1", ",", "0", ",", "0"}], "]"}], "[", "h1", 
           "]"}], "[", 
          RowBox[{
           RowBox[{"x", "[", "0", "]"}], ",", 
           RowBox[{"x", "[", "1", "]"}], ",", 
           RowBox[{"x", "[", "2", "]"}], ",", 
           RowBox[{"x", "[", "3", "]"}]}], "]"}]}], "-", 
        RowBox[{"3", " ", "calH", " ", 
         RowBox[{
          RowBox[{
           RowBox[{"Derivative", "[", 
            RowBox[{"0", ",", "0", ",", "1", ",", "0"}], "]"}], "[", "h2", 
           "]"}], "[", 
          RowBox[{
           RowBox[{"x", "[", "0", "]"}], ",", 
           RowBox[{"x", "[", "1", "]"}], ",", 
           RowBox[{"x", "[", "2", "]"}], ",", 
           RowBox[{"x", "[", "3", "]"}]}], "]"}]}], "-", 
        RowBox[{"3", " ", "calH", " ", 
         RowBox[{
          RowBox[{
           RowBox[{"Derivative", "[", 
            RowBox[{"0", ",", "0", ",", "0", ",", "1"}], "]"}], "[", "h3", 
           "]"}], "[", 
          RowBox[{
           RowBox[{"x", "[", "0", "]"}], ",", 
           RowBox[{"x", "[", "1", "]"}], ",", 
           RowBox[{"x", "[", "2", "]"}], ",", 
           RowBox[{"x", "[", "3", "]"}]}], "]"}]}], "-", 
        RowBox[{
         RowBox[{
          RowBox[{"Derivative", "[", 
           RowBox[{"2", ",", "0", ",", "0", ",", "0"}], "]"}], "[", "theta11",
           "]"}], "[", 
         RowBox[{
          RowBox[{"x", "[", "0", "]"}], ",", 
          RowBox[{"x", "[", "1", "]"}], ",", 
          RowBox[{"x", "[", "2", "]"}], ",", 
          RowBox[{"x", "[", "3", "]"}]}], "]"}], "-", 
        RowBox[{
         RowBox[{
          RowBox[{"Derivative", "[", 
           RowBox[{"2", ",", "0", ",", "0", ",", "0"}], "]"}], "[", "theta22",
           "]"}], "[", 
         RowBox[{
          RowBox[{"x", "[", "0", "]"}], ",", 
          RowBox[{"x", "[", "1", "]"}], ",", 
          RowBox[{"x", "[", "2", "]"}], ",", 
          RowBox[{"x", "[", "3", "]"}]}], "]"}], "-", 
        RowBox[{
         RowBox[{
          RowBox[{"Derivative", "[", 
           RowBox[{"2", ",", "0", ",", "0", ",", "0"}], "]"}], "[", "theta33",
           "]"}], "[", 
         RowBox[{
          RowBox[{"x", "[", "0", "]"}], ",", 
          RowBox[{"x", "[", "1", "]"}], ",", 
          RowBox[{"x", "[", "2", "]"}], ",", 
          RowBox[{"x", "[", "3", "]"}]}], "]"}], "-", 
        RowBox[{"3", " ", "calH", " ", 
         RowBox[{
          RowBox[{
           RowBox[{"Derivative", "[", 
            RowBox[{"1", ",", "0", ",", "0", ",", "0"}], "]"}], "[", 
           "theta11", "]"}], "[", 
          RowBox[{
           RowBox[{"x", "[", "0", "]"}], ",", 
           RowBox[{"x", "[", "1", "]"}], ",", 
           RowBox[{"x", "[", "2", "]"}], ",", 
           RowBox[{"x", "[", "3", "]"}]}], "]"}]}], "-", 
        RowBox[{"3", " ", "calH", " ", 
         RowBox[{
          RowBox[{
           RowBox[{"Derivative", "[", 
            RowBox[{"1", ",", "0", ",", "0", ",", "0"}], "]"}], "[", 
           "theta22", "]"}], "[", 
          RowBox[{
           RowBox[{"x", "[", "0", "]"}], ",", 
           RowBox[{"x", "[", "1", "]"}], ",", 
           RowBox[{"x", "[", "2", "]"}], ",", 
           RowBox[{"x", "[", "3", "]"}]}], "]"}]}], "-", 
        RowBox[{"3", " ", "calH", " ", 
         RowBox[{
          RowBox[{
           RowBox[{"Derivative", "[", 
            RowBox[{"1", ",", "0", ",", "0", ",", "0"}], "]"}], "[", 
           "theta33", "]"}], "[", 
          RowBox[{
           RowBox[{"x", "[", "0", "]"}], ",", 
           RowBox[{"x", "[", "1", "]"}], ",", 
           RowBox[{"x", "[", "2", "]"}], ",", 
           RowBox[{"x", "[", "3", "]"}]}], "]"}]}], "-", 
        RowBox[{
         RowBox[{
          RowBox[{"Derivative", "[", 
           RowBox[{"0", ",", "2", ",", "0", ",", "0"}], "]"}], "[", "theta11",
           "]"}], "[", 
         RowBox[{
          RowBox[{"x", "[", "0", "]"}], ",", 
          RowBox[{"x", "[", "1", "]"}], ",", 
          RowBox[{"x", "[", "2", "]"}], ",", 
          RowBox[{"x", "[", "3", "]"}]}], "]"}], "-", 
        RowBox[{
         RowBox[{
          RowBox[{"Derivative", "[", 
           RowBox[{"0", ",", "0", ",", "2", ",", "0"}], "]"}], "[", "theta22",
           "]"}], "[", 
         RowBox[{
          RowBox[{"x", "[", "0", "]"}], ",", 
          RowBox[{"x", "[", "1", "]"}], ",", 
          RowBox[{"x", "[", "2", "]"}], ",", 
          RowBox[{"x", "[", "3", "]"}]}], "]"}], "-", 
        RowBox[{
         RowBox[{
          RowBox[{"Derivative", "[", 
           RowBox[{"0", ",", "0", ",", "0", ",", "2"}], "]"}], "[", "theta33",
           "]"}], "[", 
         RowBox[{
          RowBox[{"x", "[", "0", "]"}], ",", 
          RowBox[{"x", "[", "1", "]"}], ",", 
          RowBox[{"x", "[", "2", "]"}], ",", 
          RowBox[{"x", "[", "3", "]"}]}], "]"}], "-", 
        RowBox[{"2", " ", 
         RowBox[{
          RowBox[{
           RowBox[{"Derivative", "[", 
            RowBox[{"0", ",", "1", ",", "1", ",", "0"}], "]"}], "[", 
           "theta12", "]"}], "[", 
          RowBox[{
           RowBox[{"x", "[", "0", "]"}], ",", 
           RowBox[{"x", "[", "1", "]"}], ",", 
           RowBox[{"x", "[", "2", "]"}], ",", 
           RowBox[{"x", "[", "3", "]"}]}], "]"}]}], "-", 
        RowBox[{"2", " ", 
         RowBox[{
          RowBox[{
           RowBox[{"Derivative", "[", 
            RowBox[{"0", ",", "1", ",", "0", ",", "1"}], "]"}], "[", 
           "theta13", "]"}], "[", 
          RowBox[{
           RowBox[{"x", "[", "0", "]"}], ",", 
           RowBox[{"x", "[", "1", "]"}], ",", 
           RowBox[{"x", "[", "2", "]"}], ",", 
           RowBox[{"x", "[", "3", "]"}]}], "]"}]}], "-", 
        RowBox[{"2", " ", 
         RowBox[{
          RowBox[{
           RowBox[{"Derivative", "[", 
            RowBox[{"0", ",", "0", ",", "1", ",", "1"}], "]"}], "[", 
           "theta23", "]"}], "[", 
          RowBox[{
           RowBox[{"x", "[", "0", "]"}], ",", 
           RowBox[{"x", "[", "1", "]"}], ",", 
           RowBox[{"x", "[", "2", "]"}], ",", 
           RowBox[{"x", "[", "3", "]"}]}], "]"}]}]}], ")"}]}]}]}], ";"}], 
  "\n"}], "\[IndentingNewLine]", 
 RowBox[{"Series", "[", 
  RowBox[{
   RowBox[{"ricciscalar", "-", "testricciscalar"}], ",", 
   RowBox[{"{", 
    RowBox[{"eps", ",", "0", ",", "1"}], "}"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.977011317136732*^9, 3.9770113205301228`*^9}, 
   3.977035642858967*^9, {3.979031664445627*^9, 3.979031666048334*^9}},
 CellLabel->"In[37]:=",ExpressionUUID->"57e587e3-eae7-4302-8d08-218e02de84e1"],

Cell[BoxData[
 InterpretationBox[
  SuperscriptBox[
   RowBox[{"O", "[", "eps", "]"}], "2"],
  SeriesData[$CellContext`eps, 0, {}, 2, 2, 1],
  Editable->False]], "Output",
 CellChangeTimes->{3.979031688270546*^9},
 CellLabel->"Out[40]=",ExpressionUUID->"54d6b0c8-498f-4351-9130-c7e5c13b7fab"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
WindowSize->{606, 581.25},
WindowMargins->{{Automatic, 241.5}, {Automatic, 10.5}},
Magnification:>0.75 Inherited,
FrontEndVersion->"14.0 for Linux x86 (64-bit) (December 12, 2023)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"291b0b5e-3512-4395-80e4-31933cbeca18"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[576, 22, 227, 6, 61, "Subsection",ExpressionUUID->"d06c4045-7009-45c2-af5c-05575649d531"],
Cell[CellGroupData[{
Cell[828, 32, 166, 3, 34, "Subsubsection",ExpressionUUID->"b6d3b268-42ec-4627-952d-c8abe4884ab1"],
Cell[997, 37, 7158, 227, 315, "Input",ExpressionUUID->"b0fa8cd4-7abf-436d-b225-af325b78b66f"]
}, Open  ]],
Cell[CellGroupData[{
Cell[8192, 269, 172, 3, 34, "Subsubsection",ExpressionUUID->"cd4ad19d-a32f-44ba-b66c-94a6b8ba8a73"],
Cell[8367, 274, 7661, 250, 361, "Input",ExpressionUUID->"f9bf80b5-3a33-429b-a8f5-896529d9d37b"]
}, Open  ]],
Cell[CellGroupData[{
Cell[16065, 529, 171, 3, 34, "Subsubsection",ExpressionUUID->"d6bc33f2-ebd1-405a-aacf-7fd7714c65bc"],
Cell[16239, 534, 1126, 31, 102, "Input",ExpressionUUID->"b5d1a9ae-6d17-4a4f-ad4c-cc04529babfe"]
}, Open  ]],
Cell[CellGroupData[{
Cell[17402, 570, 186, 3, 34, "Subsubsection",ExpressionUUID->"4323374a-9c9a-4513-b1b0-1793565ed42a"],
Cell[17591, 575, 1670, 46, 68, "Input",ExpressionUUID->"265ffdda-acec-471c-b1bc-f372132d0eee"]
}, Open  ]],
Cell[CellGroupData[{
Cell[19298, 626, 184, 3, 34, "Subsubsection",ExpressionUUID->"a1e21628-467b-44fe-96fc-70df45720cab"],
Cell[19485, 631, 536, 14, 22, "Input",ExpressionUUID->"34af23d8-c893-4cb6-b9df-89d75821d60f"]
}, Open  ]],
Cell[CellGroupData[{
Cell[20058, 650, 163, 3, 34, "Subsubsection",ExpressionUUID->"f1d9d585-6900-4b1d-880e-3ec4aa71cea0"],
Cell[20224, 655, 397, 9, 22, "Input",ExpressionUUID->"8704d10f-9966-404c-a26e-856ad1e842af"]
}, Open  ]],
Cell[CellGroupData[{
Cell[20658, 669, 209, 4, 34, "Subsubsection",ExpressionUUID->"3304e6bf-f1bc-4ba2-ae9d-035394a91b25"],
Cell[CellGroupData[{
Cell[20892, 677, 16791, 444, 669, "Input",ExpressionUUID->"57e587e3-eae7-4302-8d08-218e02de84e1"],
Cell[37686, 1123, 292, 7, 50, "Output",ExpressionUUID->"54d6b0c8-498f-4351-9130-c7e5c13b7fab"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)

